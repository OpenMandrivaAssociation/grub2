From 4bd4022c48a2086b78725859f4c6f61aac5660c6 Mon Sep 17 00:00:00 2001
From: William Jon McCann <william.jon.mccann@gmail.com>
Date: Wed, 15 May 2013 13:30:20 -0400
Subject: [PATCH 468/482] Don't write messages to the screen

Writing messages to the screen before the menus or boot splash
happens so quickly it looks like something is wrong and isn't
very appealing.
---
diff -Naur grub-2.00/grub-core/boot/i386/pc/boot.S grub-2.00.tpg/grub-core/boot/i386/pc/boot.S
--- grub-2.00/grub-core/boot/i386/pc/boot.S	2011-10-19 18:46:09.000000000 +0000
+++ grub-2.00.tpg/grub-core/boot/i386/pc/boot.S	2013-07-19 15:18:41.383442225 +0000
@@ -150,9 +150,6 @@
 	/* save drive reference first thing! */
 	pushw	%dx
 
-	/* print a notification message on the screen */
-	MSG(notification_string)
-
 	/* set %si to the disk address packet */
 	movw	$disk_address_packet, %si
 
diff -Naur grub-2.00/grub-core/boot/i386/pc/diskboot.S grub-2.00.tpg/grub-core/boot/i386/pc/diskboot.S
--- grub-2.00/grub-core/boot/i386/pc/diskboot.S	2012-06-23 09:10:37.000000000 +0000
+++ grub-2.00.tpg/grub-core/boot/i386/pc/diskboot.S	2013-07-19 15:19:15.117361968 +0000
@@ -50,11 +50,6 @@
 	/* save drive reference first thing! */
 	pushw	%dx
 
-	/* print a notification message on the screen */
-	pushw	%si
-	MSG(notification_string)
-	popw	%si
-
 	/* this sets up for the first run through "bootloop" */
 	movw	$LOCAL(firstlist), %di
 
diff -Naur grub-2.00/grub-core/gettext/gettext.c grub-2.00.tpg/grub-core/gettext/gettext.c
--- grub-2.00/grub-core/gettext/gettext.c	2012-06-22 15:26:38.000000000 +0000
+++ grub-2.00.tpg/grub-core/gettext/gettext.c	2013-07-19 15:21:35.138497733 +0000
@@ -422,14 +422,8 @@
   grub_err_t err;
   err = grub_gettext_init_ext (&main_context, val, grub_env_get ("locale_dir"),
 			       grub_env_get ("prefix"));
-  if (err)
-    grub_print_error ();
-
   err = grub_gettext_init_ext (&secondary_context, val,
 			       grub_env_get ("secondary_locale_dir"), 0);
-  if (err)
-    grub_print_error ();
-
   return grub_strdup (val);
 }
 
@@ -440,8 +434,6 @@
   err = grub_gettext_init_ext (&main_context, grub_env_get ("lang"), 
 			       grub_env_get ("locale_dir"),
 			       val);
-  if (err)
-    grub_print_error ();
 }
 
 static char *
@@ -451,8 +443,6 @@
   grub_err_t err;
   err = grub_gettext_init_ext (&main_context, grub_env_get ("lang"), val,
 			       grub_env_get ("prefix"));
-  if (err)
-    grub_print_error ();
   return grub_strdup (val);
 }
 
@@ -463,10 +453,6 @@
   grub_err_t err;
   err = grub_gettext_init_ext (&secondary_context, grub_env_get ("lang"), val,
 			       0);
-  if (err)
-    grub_print_error ();
-
-  return grub_strdup (val);
 }
 
 static grub_err_t
@@ -491,12 +477,8 @@
 
   err = grub_gettext_init_ext (&main_context, lang, grub_env_get ("locale_dir"),
 			       grub_env_get ("prefix"));
-  if (err)
-    grub_print_error ();
   err = grub_gettext_init_ext (&secondary_context, lang,
 			       grub_env_get ("secondary_locale_dir"), 0);
-  if (err)
-    grub_print_error ();
 
   grub_register_variable_hook ("locale_dir", NULL, read_main);
   grub_register_variable_hook ("secondary_locale_dir", NULL, read_secondary);
diff -Naur grub-2.00/grub-core/kern/main.c grub-2.00.tpg/grub-core/kern/main.c
--- grub-2.00/grub-core/kern/main.c	2012-06-25 20:33:41.000000000 +0000
+++ grub-2.00.tpg/grub-core/kern/main.c	2013-07-19 15:22:44.510629986 +0000
@@ -210,11 +210,6 @@
   /* First of all, initialize the machine.  */
   grub_machine_init ();
 
-  /* Hello.  */
-  grub_setcolorstate (GRUB_TERM_COLOR_HIGHLIGHT);
-  grub_printf ("Welcome to GRUB!\n\n");
-  grub_setcolorstate (GRUB_TERM_COLOR_STANDARD);
-
   /* Load pre-loaded modules and free the space.  */
   grub_register_exported_symbols ();
 #ifdef GRUB_LINKER_HAVE_INIT
diff -Naur grub-2.00/util/grub.d/10_linux.in grub-2.00.tpg/util/grub.d/10_linux.in
--- grub-2.00/util/grub.d/10_linux.in	2013-07-19 15:16:59.000000000 +0000
+++ grub-2.00.tpg/util/grub.d/10_linux.in	2013-07-19 15:26:26.121674384 +0000
@@ -132,16 +132,11 @@
     fi
     printf '%s\n' "${prepare_boot_cache}" | sed "s/^/$submenu_indentation/"
   fi
-  message="$(gettext_printf "Loading Linux %s ..." ${version})"
   sed "s/^/$submenu_indentation/" << EOF
-	echo	'$message'
 	linux  ${rel_dirname}/${basename} root=${linux_root_device_thisversion} ro ${args} resume=`swapon -s | grep '/dev/sd.[0-9]\{1,\}' -o | if read line; then echo "$line"; fi` init=/lib/systemd/systemd
 EOF
   if test -n "${initrd}" ; then
-    # TRANSLATORS: ramdisk isn't identifier. Should be translated.
-    message="$(gettext_printf "Loading initial ramdisk ...")"
     sed "s/^/$submenu_indentation/" << EOF
-	echo	'$message'
 	initrd	${rel_dirname}/${initrd}
 EOF
   fi
